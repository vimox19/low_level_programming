more functions ad nested loop
